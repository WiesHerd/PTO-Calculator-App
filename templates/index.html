{% extends "layout.html" %}
{% block title %}Home{% endblock %}
{% block head %}
<style>
    .card {
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .display-4 {
        font-weight: bold;
    }
    .table th {
        background-color: #f8f9fa;
    }
</style>
{% endblock %}
{% block content %}
    <div class="card mb-4">
        <div class="card-body">
            <h2>Summary of Entered Data</h2>
            <ul>
                <li>Statutory Holidays: {{ holidays|length }} (Total Hours: {{ total_holiday_hours }})</li>
                <li>Vacations: {{ vacations|length }} (Total Hours: {{ total_vacation_hours }})</li>
            </ul>
        </div>
    </div>

    <form method="POST" action="{{ url_for('home') }}">
        <div class="row mb-3">
            <div class="col-md-6">
                <label for="start_date" class="form-label">Start Date of Employment</label>
                <input type="date" class="form-control" id="start_date" name="start_date" value="{{ user_inputs.start_date }}" required>
            </div>
            <div class="col-md-6">
                <label for="current_pto" class="form-label">Current PTO Balance (Hours)</label>
                <input type="number" class="form-control" id="current_pto" name="current_pto" value="{{ user_inputs.current_pto }}" required>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-6">
                <label for="current_pp_start" class="form-label">Current Pay Period Start Date</label>
                <input type="date" class="form-control" id="current_pp_start" name="current_pp_start" value="{{ user_inputs.current_pp_start }}" required>
            </div>
            <div class="col-md-6">
                <label for="future_date" class="form-label">Target Future Date</label>
                <input type="date" class="form-control" id="future_date" name="future_date" value="{{ user_inputs.future_date }}" required>
            </div>
        </div>
        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="include_holidays" name="include_holidays" {% if user_inputs.include_holidays %}checked{% endif %}>
            <label class="form-check-label" for="include_holidays">Include Statutory Holidays in PTO</label>
        </div>
        <button type="submit" class="btn btn-primary">Calculate PTO Forecast</button>
    </form>

    {% if forecasted_pto is not none %}
    <div class="mt-5">
        <div class="card bg-light">
            <div class="card-body">
                <h2 class="card-title text-center mb-4">PTO Forecast Results</h2>
                <div class="row align-items-center">
                    <div class="col-md-6 text-center">
                        <h3>Forecasted PTO Balance</h3>
                        <p class="display-4 text-primary">{{ forecasted_pto }} hours</p>
                    </div>
                    <div class="col-md-6 text-center">
                        <h3>As of Date</h3>
                        <p class="display-4 text-secondary">{{ user_inputs.future_date }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-5">
        <h3>PTO Accrual Details</h3>
        <div class="table-responsive">
            <table class="table table-striped table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Pay Period</th>
                        <th>Length of Service</th>
                        <th>Hours Accrued</th>
                        <th>Vacation Hours</th>
                        <th>Holiday Hours</th>
                        <th>Total PTO Hours</th>
                        <th>Total PTO Days</th>
                    </tr>
                </thead>
                <tbody>
                    {% for detail in pto_detail %}
                    <tr>
                        <td>{{ detail.pay_period_start }} to {{ detail.pay_period_end }}</td>
                        <td>{{ detail.length_of_service }} years</td>
                        <td>{{ detail.hours_accrued }}</td>
                        <td>{{ detail.vacation_hours }}</td>
                        <td>{{ detail.holiday_hours }}</td>
                        <td>{{ detail.total_pto_hours }}</td>
                        <td>{{ detail.total_pto_days }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}
{% endblock %}
